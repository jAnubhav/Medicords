@startuml MediCords Activity Diagram
skinparam ActivityBackgroundColor LightBlue
skinparam ActivityBorderColor DarkBlue

start

fork
  :User Authentication;
  if (Valid Credentials?) then (yes)
    :Dashboard Access;
  else (no)
    :Show Error Message;
    stop
  endif
fork again
  :Smart Contract Initialization;
  :Deploy Medical Records Contract;
  :Initialize Storage Tables;
end fork

:Medical Record Management;

fork
  :Create New Record;
  :Validate Data;
  :Store in Blockchain;
fork again
  :View Records;
  :Fetch from Table Storage;
  :Decrypt Data;
fork again
  :Update Record;
  :Verify Permissions;
  :Update Blockchain State;
end fork

:Access Control Management;

switch (User Role)
case (Patient)
  :View Own Records;
  :Grant Access;
case (Doctor)
  :View Authorized Records;
  :Add Medical Notes;
case (Admin)
  :Manage System;
  :Handle Permissions;
endswitch

fork
  :Transaction Processing;
  :Update Blockchain State;
fork again
  :Event Logging;
  :Emit Blockchain Events;
end fork

stop

@enduml